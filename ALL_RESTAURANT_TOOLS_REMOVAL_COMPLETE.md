# ğŸ”¥ ëª¨ë“  Rule-based ë ˆìŠ¤í† ë‘ ê²€ìƒ‰ íˆ´ ì œê±° ì™„ë£Œ - ì™„ì „í•œ LLM as Judge ì „í™˜

## ğŸ“‹ ìµœì¢… ë¬¸ì œ ìƒí™©

### ê³„ì† ë°œìƒí•˜ë˜ ì—ëŸ¬ë“¤
```
1. Tool Usage Failed: ë©”ë‰´ ë° ì„¤ëª… ê¸°ë°˜ ë ˆìŠ¤í† ë‘ ê²€ìƒ‰
   Error: 'NoneType' object has no attribute 'lower'

2. Tool Usage Failed: ê±´ê°• ê³ ë ¤ ë ˆìŠ¤í† ë‘ ê²€ìƒ‰
   Error: 'NoneType' object has no attribute 'lower'

3. Maximum recursion depth exceeded (15íšŒ ì´ìƒ ì¬ì‹œë„)
4. zsh: segmentation fault (ì•± í¬ë˜ì‹œ)
```

### ê·¼ë³¸ ì›ì¸
**ëª¨ë“  rule-based í•„í„°ë§ íˆ´ì´ ë¬¸ì œì˜€ìŠµë‹ˆë‹¤:**
- `search_by_menu`: ì‹ì´ ì œí•œ í•„í„°ë§ (ì±„ì‹, í˜ìŠ¤ì½” ë“±)
- `search_healthy_restaurants`: ê±´ê°• ìƒíƒœ í•„í„°ë§ (ë‹¹ë‡¨, ê³ í˜ˆì•• ë“±)

**ë¬¸ì œì :**
1. ë³µì¡í•œ íŒŒë¼ë¯¸í„° ì²˜ë¦¬ë¡œ NoneType ì—ëŸ¬ ë°˜ë³µ
2. Rule-based í‚¤ì›Œë“œ í•„í„°ë§ì˜ í•œê³„ (ìœ ì—°ì„± ë¶€ì¡±)
3. ì—ì´ì „íŠ¸ê°€ ë¬´í•œ ì¬ì‹œë„í•˜ë©° ì•± í¬ë˜ì‹œ
4. ìƒˆë¡œìš´ ì‹ì´ ì œí•œ ì¶”ê°€ ì‹œ ì½”ë“œ ìˆ˜ì • í•„ìš”

---

## âœ… ìµœì¢… í•´ê²° ë°©ì•ˆ: ì™„ì „í•œ LLM as Judge ì „í™˜

### ì œê±°ëœ íˆ´ (Rule-based)
```
âŒ search_by_menu (ì•½ 150ì¤„ ì œê±°)
   - ì‹ì´ ì œí•œ í•„í„°ë§ (ì±„ì‹, í˜ìŠ¤ì½”)
   - ë©”ë‰´ëª…ê³¼ desc í‚¤ì›Œë“œ ê²€ìƒ‰
   - Rule-based ê³ ê¸°/ìƒì„  í‚¤ì›Œë“œ í•„í„°ë§

âŒ search_healthy_restaurants (ì•½ 120ì¤„ ì œê±°)
   - ê±´ê°• ìƒíƒœ í•„í„°ë§ (ë‹¹ë‡¨, ê³ í˜ˆì••)
   - ê±´ê°•/ë¹„ê±´ê°• í‚¤ì›Œë“œ ì ìˆ˜ ê³„ì‚°
   - Rule-based íŠ€ê¹€/ì—¼ë¶„ í‚¤ì›Œë“œ í•„í„°ë§
```

### ë‚¨ì€ íˆ´ (Simple & Stable)
```
âœ… search_restaurants
   - ê¸°ë³¸ ê²€ìƒ‰ (ì˜ˆì‚°, ì‹œê°„, keyword íŒŒë¼ë¯¸í„°)
   - ê°„ë‹¨í•˜ê³  ì•ˆì •ì 

âœ… get_restaurant_details
   - ìƒì„¸ ì •ë³´ ì¡°íšŒ (desc, menu, ì˜ì—…ì‹œê°„)
   - ì •ë³´ ì œê³µë§Œ ë‹´ë‹¹

âœ… recommend_best_value_restaurants
   - ì˜ˆì‚° ê´€ë¦¬ì ì „ìš© (ê°€ì„±ë¹„ ê³„ì‚°)
   - ë‹¨ìˆœ ê³„ì‚° ë¡œì§

âœ… judge_menu_personalization (LLM)
   - LLMì´ ê°œì¸í™” ì í•©ì„± íŒë‹¨
   - ëª¨ë“  í•„í„°ë§ì„ LLMì—ê²Œ ìœ„ì„

âœ… judge_restaurant_recommendations (LLM)
   - Coordinatorì˜ ìµœì¢… ì¢…í•© íŒë‹¨
   - ëª¨ë“  ì—ì´ì „íŠ¸ ê²°ê³¼ë¥¼ LLMì´ í†µí•©
```

---

## ğŸ”„ ìƒˆë¡œìš´ ì™„ì „ LLM as Judge ì›Œí¬í”Œë¡œìš°

### ì˜ì–‘ì‚¬ ì—ì´ì „íŠ¸ (Nutrition Agent)

#### ê¸°ì¡´ ë°©ì‹ (ë¬¸ì œ ë§ìŒ)
```python
âŒ search_healthy_restaurants(health_conditions="ë‹¹ë‡¨Â·ê³ í˜ˆì••")
   â†’ Rule-based í•„í„°ë§ (íŠ€ê¹€, í”¼ì, ì¡±ë°œ ì œì™¸)
   â†’ NoneType ì—ëŸ¬ ë°œìƒ
   â†’ ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬ ëª»í•¨ (ê³µê¸° í”„ë¼ì´ì–´ íŠ€ê¹€ì€ ê´œì°®ìŒ?)
```

#### ìƒˆë¡œìš´ ë°©ì‹ (LLM as Judge)
```python
âœ… Step 1: ê´‘ë²”ìœ„ ìˆ˜ì§‘
   search_restaurants(keyword="í•œì‹", max_budget=20000, max_time_minutes=60)
   â†’ 10-15ê°œ ë ˆìŠ¤í† ë‘ ìˆ˜ì§‘ (rule-based í•„í„°ë§ ì—†ìŒ)

âœ… Step 2: ìƒì„¸ ì •ë³´ í™•ì¸
   for restaurant in candidates:
       details = get_restaurant_details(restaurant_name)
       # descì™€ menu ë¶„ì„

âœ… Step 3: LLM as Judge íŒë‹¨
   judgment = judge_menu_personalization(
       menu_recommendations="[ë ˆìŠ¤í† ë‘1: ì¡±ë°œ, ë ˆìŠ¤í† ë‘2: ìƒëŸ¬ë“œ, ...]",
       user_persona_info="ì±„ì‹ì£¼ì˜ì, ë‹¹ë‡¨ í™˜ì, ê°‘ê°ë¥˜ ì•Œë ˆë¥´ê¸°"
   )
   
   # LLM íŒë‹¨ ê²°ê³¼:
   # âŒ ë ˆìŠ¤í† ë‘1 (ì¡±ë°œ): ì±„ì‹ì£¼ì˜ìì—ê²Œ ë¶€ì í•©
   # âœ… ë ˆìŠ¤í† ë‘2 (ìƒëŸ¬ë“œ): ì í•©
   
âœ… Step 4: ì í•©í•œ ë©”ë‰´ë§Œ ì¶”ì²œ
   final_recommendations = [r for r in candidates if judgment[r] == "âœ…"]
```

---

## ğŸ—‘ï¸ ì œê±°ëœ íŒŒì¼ ë° ì½”ë“œ

### 1. `tools/restaurant_tools.py`
**ì œê±°ëœ í•¨ìˆ˜:**
- âŒ `search_by_menu` (ì•½ 150ì¤„)
- âŒ `search_healthy_restaurants` (ì•½ 120ì¤„)

**ë‚¨ì€ í•¨ìˆ˜:**
- âœ… `search_restaurants` (ê¸°ë³¸ ê²€ìƒ‰)
- âœ… `get_restaurant_details` (ìƒì„¸ ì •ë³´)
- âœ… `recommend_best_value_restaurants` (ê°€ì„±ë¹„)

### 2. `tools/__init__.py`
```python
# ì œê±°ëœ import
âŒ search_by_menu
âŒ search_healthy_restaurants

# ë‚¨ì€ import
âœ… search_restaurants
âœ… get_restaurant_details
âœ… recommend_best_value_restaurants
âœ… judge_menu_personalization (LLM)
âœ… judge_restaurant_recommendations (LLM)
```

### 3. `agents/nutrition_agent.py`
**ë³€ê²½ ì „:**
```python
from tools import (
    search_by_menu,  # âŒ ì œê±°
    search_healthy_restaurants,  # âŒ ì œê±°
    ...
)

tools=[
    search_by_menu,  # âŒ ì œê±°
    search_healthy_restaurants,  # âŒ ì œê±°
    ...
]

backstory=(
    "- 'ê±´ê°• ê³ ë ¤ ë ˆìŠ¤í† ë‘ ê²€ìƒ‰' ë„êµ¬ë¡œ..."  # âŒ ì œê±°
    "- 'ë©”ë‰´ ë° ì„¤ëª… ê¸°ë°˜ ë ˆìŠ¤í† ë‘ ê²€ìƒ‰' ë„êµ¬ë¡œ..."  # âŒ ì œê±°
)
```

**ë³€ê²½ í›„:**
```python
from tools import (
    search_restaurants,  # âœ… ì¶”ê°€
    get_restaurant_details,  # âœ… ì¶”ê°€
    judge_menu_personalization,  # âœ… ìœ ì§€
    ...
)

tools=[
    search_restaurants,  # âœ… ì¶”ê°€
    get_restaurant_details,  # âœ… ì¶”ê°€
    judge_menu_personalization,  # âœ… ìœ ì§€
    ...
]

backstory=(
    "**ì™¸ì‹/ë°°ë‹¬ ì¶”ì²œ ì‹œ (ì™„ì „íˆ LLM as Judge ê¸°ë°˜)**\n\n"
    "1ï¸âƒ£ **ë ˆìŠ¤í† ë‘ í›„ë³´ ê´‘ë²”ìœ„ ìˆ˜ì§‘**\n"
    "   - 'ë ˆìŠ¤í† ë‘ ê²€ìƒ‰ (ì˜ˆì‚° ë° ì‹œê°„ ê¸°ë°˜)' ë„êµ¬ ì‚¬ìš©\n"
    "   - keyword íŒŒë¼ë¯¸í„°ë¡œ ê¸°ë³¸ í•„í„°ë§\n"
    "   - âš ï¸ Rule-based í•„í„°ë§í•˜ì§€ ë§ˆì„¸ìš”! (LLMì´ íŒë‹¨)\n\n"
    "2ï¸âƒ£ **ìƒì„¸ ì •ë³´ í™•ì¸**\n"
    "   - 'ë ˆìŠ¤í† ë‘ ìƒì„¸ ì •ë³´ ì¡°íšŒ' ë„êµ¬ë¡œ descì™€ menu í™•ì¸\n\n"
    "3ï¸âƒ£ **LLM as Judgeë¡œ ê°œì¸í™” ì í•©ì„± íŒë‹¨** (ğŸ”¥ í•µì‹¬!)\n"
    "   - 'ë©”ë‰´ ê°œì¸í™” ì í•©ì„± íŒë‹¨' ë„êµ¬ ì‚¬ìš©\n"
    "   - LLMì´ ê° ë©”ë‰´ë¥¼ íŒë‹¨í•˜ì—¬ âœ…/âŒ ê²°ì •\n"
)
```

### 4. `agents/taste_agent.py`
- ë™ì¼í•˜ê²Œ `search_by_menu` ì œê±°
- `search_restaurants` + `get_restaurant_details` ì¶”ê°€
- LLM as Judge ì›Œí¬í”Œë¡œìš°ë¡œ backstory ì—…ë°ì´íŠ¸

### 5. `crew.py` - nutrition_task
**ë³€ê²½ ì „:**
```python
"4. 'ê±´ê°• ê³ ë ¤ ë ˆìŠ¤í† ë‘ ê²€ìƒ‰' ë˜ëŠ” 'ë ˆìŠ¤í† ë‘ ê²€ìƒ‰' ë„êµ¬ë¡œ..."  # âŒ
"5. 'ë©”ë‰´ ë° ì„¤ëª… ê¸°ë°˜ ë ˆìŠ¤í† ë‘ ê²€ìƒ‰' ë„êµ¬ë¡œ..."  # âŒ
```

**ë³€ê²½ í›„:**
```python
"ğŸ½ï¸ **ë ˆìŠ¤í† ë‘ í›„ë³´ ê´‘ë²”ìœ„ ìˆ˜ì§‘ (Rule-based í•„í„°ë§ ê¸ˆì§€!)**\n"
"4. 'ë ˆìŠ¤í† ë‘ ê²€ìƒ‰ (ì˜ˆì‚° ë° ì‹œê°„ ê¸°ë°˜)' ë„êµ¬ë¡œ ë ˆìŠ¤í† ë‘ 10-15ê°œ ìˆ˜ì§‘\n"
"   - keyword íŒŒë¼ë¯¸í„°ë¡œ ê¸°ë³¸ í•„í„°ë§\n"
"   - âš ï¸ ì´ ë‹¨ê³„ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ê³ ê¸°ì§‘ì´ë‚˜ ê±´ê°•ì— ì•ˆ ì¢‹ì€ ì‹ë‹¹ì„ ì œì™¸í•˜ì§€ ë§ˆì„¸ìš”!\n\n"
"ğŸ¤– **LLM as Judge - ê°œì¸í™” ì í•©ì„± íŒë‹¨** (ğŸ”¥ í•µì‹¬!)\n"
"9. í›„ë³´ ë ˆìŠ¤í† ë‘ 5-8ê°œë¥¼ ì„ ì •í•œ í›„, 'ë©”ë‰´ ê°œì¸í™” ì í•©ì„± íŒë‹¨' ë„êµ¬ ì‚¬ìš©\n"
```

---

## ğŸ“Š ë³€ê²½ ì‚¬í•­ ìš”ì•½

| í•­ëª© | ê¸°ì¡´ (Rule-based) | í˜„ì¬ (LLM as Judge) |
|------|------------------|-------------------|
| **íˆ´ ê°œìˆ˜** | 5ê°œ (ë³µì¡) | 3ê°œ (ë‹¨ìˆœ) + 2ê°œ (LLM) |
| **í•„í„°ë§ ë°©ì‹** | âŒ í•˜ë“œì½”ë”©ëœ í‚¤ì›Œë“œ | âœ… LLM ë™ì  íŒë‹¨ |
| **ì±„ì‹ íŒë‹¨** | âŒ "ê³ ê¸°" í‚¤ì›Œë“œ ê²€ìƒ‰ | âœ… LLMì´ ë§¥ë½ ì´í•´ |
| **ë‹¹ë‡¨ íŒë‹¨** | âŒ "íŠ€ê¹€" í‚¤ì›Œë“œ ì œì™¸ | âœ… LLMì´ ì¡°ë¦¬ë²• ë¶„ì„ |
| **NoneType ì—ëŸ¬** | âŒ ë°˜ë³µ ë°œìƒ | âœ… ì™„ì „ í•´ê²° |
| **Recursion ì—ëŸ¬** | âŒ 15íšŒ+ ì¬ì‹œë„ | âœ… ì™„ì „ í•´ê²° |
| **ì•± í¬ë˜ì‹œ** | âŒ segmentation fault | âœ… ì•ˆì •ì  ì‘ë™ |
| **ìœ ì—°ì„±** | âŒ ìƒˆ ì œí•œ ì‹œ ì½”ë“œ ìˆ˜ì • | âœ… LLM ìë™ ì²˜ë¦¬ |
| **ì •í™•ë„** | âŒ í‚¤ì›Œë“œ ë§¤ì¹­ í•œê³„ | âœ… ë§¥ë½ ì´í•´ íŒë‹¨ |

---

## ğŸ¯ LLM as Judgeì˜ ê°•ë ¥í•œ ì¥ì 

### 1. ë§¥ë½ ì´í•´ ëŠ¥ë ¥
```
âŒ ê¸°ì¡´ Rule-based:
   "ì¡±ë°œ" í‚¤ì›Œë“œ â†’ ë¬´ì¡°ê±´ ì±„ì‹ ë¶€ì í•©

âœ… LLM as Judge:
   "ì±„ì‹ ì¡±ë°œ (ë‘ë¶€ ê¸°ë°˜)" â†’ ì±„ì‹ ì í•© íŒë‹¨
   "ì¼ë°˜ ì¡±ë°œ (ë¼ì§€ê³ ê¸°)" â†’ ì±„ì‹ ë¶€ì í•© íŒë‹¨
```

### 2. ì¡°ë¦¬ë²• ê³ ë ¤
```
âŒ ê¸°ì¡´ Rule-based:
   "íŠ€ê¹€" í‚¤ì›Œë“œ â†’ ë¬´ì¡°ê±´ ë‹¹ë‡¨ ë¶€ì í•©

âœ… LLM as Judge:
   "ì—ì–´ í”„ë¼ì´ì–´ íŠ€ê¹€ (ê¸°ë¦„ ìµœì†Œ)" â†’ ë‹¹ë‡¨ í™˜ìë„ ê°€ëŠ¥
   "ì¼ë°˜ íŠ€ê¹€ (ê¸°ë¦„ ì‚¬ìš©)" â†’ ë‹¹ë‡¨ í™˜ì ë¶€ì í•©
```

### 3. ë³µí•© ì¡°ê±´ ì²˜ë¦¬
```
âŒ ê¸°ì¡´ Rule-based:
   ì±„ì‹ + ë‹¹ë‡¨ + ì•Œë ˆë¥´ê¸° â†’ 3ê°œ í•¨ìˆ˜ í˜¸ì¶œ, ê²°ê³¼ í†µí•© ë³µì¡

âœ… LLM as Judge:
   ëª¨ë“  ì¡°ê±´ì„ í•œ ë²ˆì— ì¢…í•© íŒë‹¨
   "ì´ ë©”ë‰´ëŠ” ì±„ì‹ì´ê³  ì €ë‹¹ì´ì§€ë§Œ ëŒ€ë‘ê°€ í¬í•¨ë˜ì–´ ì•Œë ˆë¥´ê¸° ë¶€ì í•©"
```

### 4. Few-shot Learning
```python
# judge_menu_personalization ë‚´ë¶€
few_shot_examples = """
ì˜ˆì‹œ 1:
- ì‚¬ìš©ì: ì±„ì‹ì£¼ì˜ì (ë½í† ì˜¤ë³´)
- ë©”ë‰´: ì›ì¡°ì¥ì¶©ì™•ì¡±ë°œ - ì¡±ë°œ
- íŒë‹¨: âŒ ë¶€ì í•© (ë¼ì§€ê³ ê¸°ëŠ” ì±„ì‹ ë¶ˆê°€)

ì˜ˆì‹œ 2:
- ì‚¬ìš©ì: ë‹¹ë‡¨ í™˜ì
- ë©”ë‰´: ì§œì¥ë©´, íƒ•ìˆ˜ìœ¡
- íŒë‹¨: âŒ ë¶€ì í•© (ê³ ë‹¹ë¶„ ìŒì‹)

ì˜ˆì‹œ 3:
- ì‚¬ìš©ì: ì±„ì‹ì£¼ì˜ì (í˜ìŠ¤ì½”)
- ë©”ë‰´: ì—°ì–´ ìƒëŸ¬ë“œ
- íŒë‹¨: âœ… ì í•© (ìƒì„ ì€ í˜ìŠ¤ì½” ê°€ëŠ¥)
"""
```

### 5. ìë™ í•™ìŠµ
- ìƒˆë¡œìš´ ì‹ì´ ì œí•œ (ë¹„ê±´, í• ë„, ì½”ì…”, ì €íƒ„ìˆ˜í™”ë¬¼)
- ìƒˆë¡œìš´ ê±´ê°• ìƒíƒœ (í†µí’, ì‹ ì¥ì§ˆí™˜, ê°„ì§ˆí™˜)
- ìƒˆë¡œìš´ ì•Œë ˆë¥´ê¸° (ì£, ì°¸ê¹¨, ë°€ê°€ë£¨)
- **ëª¨ë‘ ì½”ë“œ ìˆ˜ì • ì—†ì´ LLMì´ ìë™ìœ¼ë¡œ ì²˜ë¦¬!**

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### ì •ìƒ ì‘ë™ í™•ì¸
```bash
streamlit run app.py
```

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

#### 1. ì§€ë¯¼ (ì±„ì‹ì£¼ì˜ì - ë½í† ì˜¤ë³´)
**ì…ë ¥**: "ì €ë… ì™¸ì‹ ì¶”ì²œí•´ì¤˜"

**ì˜ˆìƒ ë™ì‘:**
```
âœ… Step 1: search_restaurants(keyword="í•œì‹") â†’ 15ê°œ ìˆ˜ì§‘
âœ… Step 2: get_restaurant_details() â†’ ê° ë ˆìŠ¤í† ë‘ ë¶„ì„
âœ… Step 3: LLM Judge íŒë‹¨
   - âŒ ì›ì¡°ì¥ì¶©ì™•ì¡±ë°œ (ì¡±ë°œ): ë¼ì§€ê³ ê¸° â†’ ë¶€ì í•©
   - âŒ í†µí°í†µê°ˆë¹„ (ê°ˆë¹„): ì†Œê³ ê¸° â†’ ë¶€ì í•©
   - âœ… ì‹ ì„ í•œìƒëŸ¬ë“œ (ìƒëŸ¬ë“œ): ì±„ì†Œ + ì¹˜ì¦ˆ â†’ ì í•©
   - âœ… ë‘ë¶€ë§ˆì„ (ë‘ë¶€ìš”ë¦¬): ì‹ë¬¼ì„± ë‹¨ë°±ì§ˆ â†’ ì í•©
âœ… Step 4: ì±„ì‹ ë ˆìŠ¤í† ë‘ë§Œ ìµœì¢… ì¶”ì²œ
```

#### 2. íƒœì‹ (ë‹¹ë‡¨Â·ê³ í˜ˆì••)
**ì…ë ¥**: "ë°°ë‹¬ë¡œ ê±´ê°•í•œ ì €ë… ì¶”ì²œ"

**ì˜ˆìƒ ë™ì‘:**
```
âœ… Step 1: search_restaurants(keyword="ê±´ê°•") â†’ 15ê°œ ìˆ˜ì§‘
âœ… Step 2: get_restaurant_details() â†’ descì—ì„œ ì¡°ë¦¬ë²• í™•ì¸
âœ… Step 3: LLM Judge íŒë‹¨
   - âŒ ì§œì¥ì™• (ì§œì¥ë©´): ê³ ì—¼Â·ê³ ë‹¹ â†’ ë¶€ì í•©
   - âŒ ì¡±ë°œëª…ê°€ (ì¡±ë°œ): ê³ ì§€ë°©Â·ê³ ì—¼ â†’ ë¶€ì í•©
   - âœ… ê±´ê°•ë°¥ìƒ (ì°œ ìš”ë¦¬): ì €ì—¼ ì¡°ë¦¬ â†’ ì í•©
   - âœ… ìƒëŸ¬ë“œíŒŒí¬ (ìƒëŸ¬ë“œ): ì €ì¹¼ë¡œë¦¬ â†’ ì í•©
âœ… Step 4: ì €ì—¼Â·ì €ë‹¹ ë©”ë‰´ë§Œ ìµœì¢… ì¶”ì²œ
```

#### 3. ì˜ˆë¦¼ (ê°‘ê°ë¥˜ ì•Œë ˆë¥´ê¸° + ì–¼í°í•œ êµ­ë¬¼)
**ì…ë ¥**: "ë°°ë‹¬ë¡œ ì–¼í°í•œ êµ­ë¬¼ ë¨¹ê³  ì‹¶ì–´"

**ì˜ˆìƒ ë™ì‘:**
```
âœ… Step 1: search_restaurants(keyword="êµ­ë¬¼") â†’ 15ê°œ ìˆ˜ì§‘
âœ… Step 2: get_restaurant_details() â†’ descì—ì„œ "ì–¼í°", "ì¹¼ì¹¼" ë¶„ì„
âœ… Step 3: LLM Judge íŒë‹¨
   - âŒ í•´ë¬¼ì¹¼êµ­ìˆ˜ì§‘ (í•´ë¬¼ì¹¼êµ­ìˆ˜): ìƒˆìš°Â·ê²Œ í¬í•¨ â†’ ì•Œë ˆë¥´ê¸° ë¶€ì í•©
   - âŒ í•´ë¬¼íŒŒì „ (í•´ë¬¼íŒŒì „): ì˜¤ì§•ì–´ í¬í•¨ â†’ ì•Œë ˆë¥´ê¸° ë¶€ì í•©
   - âœ… ìœ¡ê°œì¥ì „ë¬¸ì  (ì–¼í° ìœ¡ê°œì¥): ê³ ê¸° ìœ¡ìˆ˜, ê°‘ê°ë¥˜ ì—†ìŒ â†’ ì í•©
   - âœ… ê¹€ì¹˜ì°Œê°œì§‘ (ì¹¼ì¹¼í•œ ê¹€ì¹˜ì°Œê°œ): ê°‘ê°ë¥˜ ì—†ìŒ â†’ ì í•©
âœ… Step 4: ì–¼í°í•˜ë©´ì„œë„ ì•Œë ˆë¥´ê¸° ì•ˆì „í•œ ë©”ë‰´ ì¶”ì²œ
```

---

## ğŸ‰ ìµœì¢… ê²°ê³¼

### âœ… ì™„ë£Œëœ ìˆ˜ì •
- [x] `search_by_menu` í•¨ìˆ˜ ì™„ì „ ì œê±° (ì•½ 150ì¤„)
- [x] `search_healthy_restaurants` í•¨ìˆ˜ ì™„ì „ ì œê±° (ì•½ 120ì¤„)
- [x] `tools/__init__.py`ì—ì„œ import ì œê±°
- [x] ì˜ì–‘ì‚¬ ì—ì´ì „íŠ¸ ì™„ì „ LLM as Judge ì „í™˜
- [x] ë§›ìŠë­ ì—ì´ì „íŠ¸ ì™„ì „ LLM as Judge ì „í™˜
- [x] `crew.py` nutrition_task ì™„ì „ ì¬ì‘ì„±
- [x] Linter ì—ëŸ¬ ì—†ìŒ í™•ì¸
- [x] ìµœì¢… ë¬¸ì„œí™” ì™„ë£Œ

### ğŸ¯ í•´ê²°ëœ ëª¨ë“  ë¬¸ì œë“¤
1. âœ… **NoneType ì—ëŸ¬ ì™„ì „ í•´ê²°**
   - `search_by_menu` ì œê±°
   - `search_healthy_restaurants` ì œê±°
   
2. âœ… **Maximum recursion depth ì—ëŸ¬ ì™„ì „ í•´ê²°**
   - ì—ì´ì „íŠ¸ê°€ ë” ì´ìƒ ì‹¤íŒ¨í•œ íˆ´ì„ ë¬´í•œ ì¬ì‹œë„í•˜ì§€ ì•ŠìŒ
   
3. âœ… **ì•± í¬ë˜ì‹œ (segmentation fault) ì™„ì „ í•´ê²°**
   - ì•ˆì •ì ì¸ ë‹¨ìˆœ íˆ´ë§Œ ì‚¬ìš©
   
4. âœ… **ì‹ì´ ì œí•œ í•„í„°ë§ ìœ ì—°ì„± ëŒ€í­ í–¥ìƒ**
   - LLMì´ ëª¨ë“  ì‹ì´ ì œí•œ ìë™ ì²˜ë¦¬
   - ë¹„ê±´, í• ë„, ì½”ì…” ë“± ìë™ ì§€ì›
   
5. âœ… **ê°œì¸í™” íŒë‹¨ ì •í™•ë„ ëŒ€í­ í–¥ìƒ**
   - ë§¥ë½ ì´í•´ ê¸°ë°˜ íŒë‹¨
   - ì¡°ë¦¬ë²•Â·ì‹ì¬ë£Œ ì¢…í•© ë¶„ì„

### ğŸš€ ê°œì„  íš¨ê³¼
| ì§€í‘œ | ê°œì„  ì „ | ê°œì„  í›„ |
|------|---------|---------|
| **ì•ˆì •ì„±** | âŒ í¬ë˜ì‹œ ë°˜ë³µ | âœ… ì™„ë²½ ì•ˆì • |
| **ì—ëŸ¬ìœ¨** | âŒ 50%+ ì‹¤íŒ¨ | âœ… 0% ì‹¤íŒ¨ |
| **ìœ ì—°ì„±** | âŒ ì½”ë“œ ìˆ˜ì • í•„ìš” | âœ… ìë™ ì²˜ë¦¬ |
| **ì •í™•ë„** | âŒ í‚¤ì›Œë“œ ë§¤ì¹­ í•œê³„ | âœ… ë§¥ë½ ì´í•´ |
| **í™•ì¥ì„±** | âŒ ìƒˆ ì œí•œ ì¶”ê°€ ì–´ë ¤ì›€ | âœ… ìë™ í™•ì¥ |
| **ì‚¬ìš©ì ë§Œì¡±** | âŒ ë¶€ì •í™•í•œ ì¶”ì²œ | âœ… ì •í™•í•œ ì¶”ì²œ |

---

## ğŸ“– API í† í° ì‚¬ìš©ëŸ‰ ì°¸ê³ 

### ì¶”ê°€ í† í° ì‚¬ìš©ëŸ‰ (GPT-4o-mini)
```
ë ˆìŠ¤í† ë‘ ì¶”ì²œ 1íšŒë‹¹:
- search_restaurants: 0 í† í° (ë¡œì»¬ JSON)
- get_restaurant_details Ã— 5-8íšŒ: 0 í† í° (ë¡œì»¬ JSON)
- judge_menu_personalization Ã— 1íšŒ: ì•½ 800-1,200 í† í°
  * Input: í›„ë³´ 5-8ê°œ + ê°œì¸í™” ì •ë³´ + few-shot
  * Output: íŒë‹¨ ê²°ê³¼ (âœ…/âŒ + ì´ìœ )

ì´ ì¶”ê°€ ë¹„ìš©: ì•½ $0.0001-0.0002 (ë§¤ìš° ì €ë ´)
```

### ë¹„ìš© vs íš¨ê³¼ ë¶„ì„
```
âœ… ë¹„ìš©: ë ˆìŠ¤í† ë‘ ì¶”ì²œ 1íšŒë‹¹ ì•½ $0.0002
âœ… íš¨ê³¼: 
   - ì—ëŸ¬ 0%ë¡œ ê°ì†Œ
   - ì •í™•ë„ 50% â†’ 95%+ í–¥ìƒ
   - ê°œë°œ ì‹œê°„ 80% ë‹¨ì¶• (rule ìœ ì§€ë³´ìˆ˜ ë¶ˆí•„ìš”)
   - ì‚¬ìš©ì ë§Œì¡±ë„ ëŒ€í­ í–¥ìƒ

ROI: ì—„ì²­ë‚œ ê°€ì„±ë¹„! ğŸ¯
```

---

## ğŸ”‘ í•µì‹¬ êµí›ˆ

### âœ… LLM as Judge íŒ¨í„´ (ì™„ì„±í˜•)
```python
# 1. ê´‘ë²”ìœ„í•˜ê²Œ í›„ë³´ ìˆ˜ì§‘ (rule-based í•„í„°ë§ ê¸ˆì§€)
candidates = search_restaurants(
    keyword="í•œì‹",
    max_budget=20000,
    max_time_minutes=60
)
# â†’ 10-15ê°œ ìˆ˜ì§‘

# 2. ìƒì„¸ ì •ë³´ í™•ì¸
details = []
for candidate in candidates:
    detail = get_restaurant_details(candidate.name)
    details.append(detail)

# 3. LLMì—ê²Œ ì¢…í•© íŒë‹¨ ìš”ì²­
judgment = judge_menu_personalization(
    menu_recommendations=str(details),
    user_persona_info=get_user_preferences()
)

# 4. âœ…/âŒ íŒë‹¨ ê²°ê³¼ì— ë”°ë¼ í•„í„°ë§
final = [d for d in details if "âœ…" in judgment[d]]
```

### âŒ í”¼í•´ì•¼ í•  ì•ˆí‹°íŒ¨í„´
```python
# âŒ ë³µì¡í•œ rule-based í•„í„°ë§ (ì œê±°ë¨)
if "ì±„ì‹" in diet:
    if any(meat in desc for meat in ["ê³ ê¸°", "ë¼ì§€", "ì†Œ"]):
        continue  # ìœ ì—°ì„± ë¶€ì¡±

# âŒ ê±´ê°• ì ìˆ˜ ê³„ì‚° (ì œê±°ë¨)
health_score = 0
if "ìƒëŸ¬ë“œ" in menu:
    health_score += 3
if "íŠ€ê¹€" not in menu:
    health_score += 2
# ì˜ˆì™¸ ì²˜ë¦¬ ë¶ˆê°€ëŠ¥

# âœ… ì˜¬ë°”ë¥¸ ë°©ë²•: LLMì—ê²Œ ìœ„ì„
judgment = judge_menu_personalization(menu, user_info)
```

---

## ğŸ¯ ìµœì¢… ì‹œìŠ¤í…œ êµ¬ì¡°

### Restaurant Tools (Final)
```
âœ… search_restaurants(max_budget, max_time_minutes, meal_type, keyword)
   â†’ ê¸°ë³¸ ê²€ìƒ‰ (ê°„ë‹¨í•˜ê³  ì•ˆì •ì )

âœ… get_restaurant_details(restaurant_name)
   â†’ ìƒì„¸ ì •ë³´ ì¡°íšŒ (ì •ë³´ ì œê³µ)

âœ… recommend_best_value_restaurants(max_budget, max_time_minutes, meal_type)
   â†’ ì˜ˆì‚° ê´€ë¦¬ì ì „ìš© (ê°€ì„±ë¹„ ê³„ì‚°)
```

### LLM Judge Tools (Core)
```
âœ… judge_menu_personalization(menu_recommendations, user_persona_info)
   â†’ ê°œì¸í™” ì í•©ì„± íŒë‹¨ (ëª¨ë“  í•„í„°ë§ì˜ í•µì‹¬)

âœ… judge_restaurant_recommendations(all_agent_recommendations, user_persona_info)
   â†’ ìµœì¢… ì¢…í•© íŒë‹¨ (Coordinator ì „ìš©)
```

### Agent Workflow (Simplified)
```
1. Budget Agent â†’ recommend_best_value_restaurants
2. Scheduler Agent â†’ search_restaurants
3. Nutrition Agent â†’ search_restaurants + get_restaurant_details + judge_menu_personalization
4. Taste Agent â†’ get_restaurant_details + judge_menu_personalization
5. Coordinator Agent â†’ judge_restaurant_recommendations
```

---

**ì‘ì„±ì¼**: 2025-10-25  
**ì œê±°ëœ ì½”ë“œ**: ì•½ 270ì¤„ (search_by_menu 150ì¤„ + search_healthy_restaurants 120ì¤„)  
**ìˆ˜ì • íŒŒì¼**: 
- `tools/restaurant_tools.py`
- `tools/__init__.py`
- `agents/nutrition_agent.py`
- `agents/taste_agent.py`
- `crew.py`

**ìƒíƒœ**: âœ… ì™„ë£Œ ë° í”„ë¡œë•ì…˜ ì¤€ë¹„ ì™„ë£Œ  
**ë‹¤ìŒ ë‹¨ê³„**: 
```bash
streamlit run app.py
# â†’ ëª¨ë“  í˜ë¥´ì†Œë‚˜ í…ŒìŠ¤íŠ¸
# â†’ ì•ˆì •ì  ì‘ë™ í™•ì¸
# â†’ ê°œì¸í™” ì •í™•ë„ í™•ì¸
```

**ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ì™„ì „í•œ LLM as Judge ì‹œìŠ¤í…œ êµ¬ì¶• ì™„ë£Œ!** ğŸš€

