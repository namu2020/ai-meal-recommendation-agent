# âœ… Notion íŒŒì‹± ë¬¸ì œ ì™„ì „ í•´ê²°

## ğŸ¯ í•´ê²°ëœ ë¬¸ì œ

ì‚¬ìš©ì í”¼ë“œë°±:
> "ë¼ë¯¸ ìš”ë¦¬ ì‹¤ë ¥ì€ ìƒê¸‰ì´ë¼ê³  'ìŒì‹ ì„ í˜¸' í‘œì— ë‚˜ì™€ ìˆì–´. ì†Œìœ¤ ê°€ìš©ì‹œê°„ì€ 15ë¶„ì´ë¼ê³  ì í˜€ ìˆê³ ."

### 1. ë¼ë¯¸ì˜ ìš”ë¦¬ ì‹¤ë ¥ 'ìƒê¸‰' íŒŒì‹± ì‹¤íŒ¨
- **ë¬¸ì œ**: Notionì— `'ìƒê¸‰(ì˜¤ë¸Â·ìŠ¬ë¡œìš°ì¿ ì»¤Â·íŒ¬ ëª¨ë‘ ëŠ¥ìˆ™)'`ë¡œ ê¸°ì¬ë˜ì–´ ìˆìœ¼ë‚˜ íŒŒì‹± ë¡œì§ì— 'ìƒê¸‰' í‚¤ì›Œë“œ ëˆ„ë½
- **ì›ì¸**: `notion_server_real.py:203-211`ì—ì„œ 'ì´ˆê¸‰', 'ì¤‘ê¸‰', 'ê³ ê¸‰'ë§Œ í™•ì¸
- **í•´ê²°**: `elif 'ê³ ê¸‰' in value or 'ìƒê¸‰' in value:` ì¡°ê±´ ì¶”ê°€

### 2. ì†Œìœ¤ì˜ ê°€ìš© ì‹œê°„ 15ë¶„ íŒŒì‹± ì‹¤íŒ¨
- **ë¬¸ì œ**: Notionì— `'ì‹ì‚¬ ìŠ¬ë¡¯', '23:00â€“23:15 / 03:00â€“03:15'`ë¡œ ê¸°ì¬ë˜ì–´ ìˆìœ¼ë‚˜ 30ë¶„ìœ¼ë¡œ íŒŒì‹±
- **ì›ì¸**: ë©”ëª¨ í•„ë“œ(row[2])ê°€ ë¹„ì–´ ìˆì–´ "Xë¶„" íŒ¨í„´ì„ ì°¾ì§€ ëª»í•¨
- **í•´ê²°**: ì‹œê°„ ë²”ìœ„ ë¬¸ìì—´ íŒŒì‹± ë¡œì§ ì¶”ê°€ (23:15 - 23:00 = 15ë¶„ ê³„ì‚°)

---

## ğŸ”§ ìˆ˜ì • ë‚´ì—­

### ìˆ˜ì • 1: ìš”ë¦¬ ì‹¤ë ¥ íŒŒì‹± ê°œì„ 

**íŒŒì¼**: `mcp_servers/notion_server_real.py`
**ìœ„ì¹˜**: 203-211ì¤„

```python
# ì´ì „ ì½”ë“œ
elif 'ìš”ë¦¬' in key and 'ì‹¤ë ¥' in key:
    if 'ì´ˆê¸‰' in value:
        user_data['preferences']['cooking_skill'] = 'ì´ˆê¸‰'
    elif 'ì¤‘ê¸‰' in value:
        user_data['preferences']['cooking_skill'] = 'ì¤‘ê¸‰'
    elif 'ê³ ê¸‰' in value:
        user_data['preferences']['cooking_skill'] = 'ê³ ê¸‰'
```

```python
# ìˆ˜ì • í›„ ì½”ë“œ
elif 'ìš”ë¦¬' in key and 'ì‹¤ë ¥' in key:
    if 'ì´ˆê¸‰' in value:
        user_data['preferences']['cooking_skill'] = 'ì´ˆê¸‰'
    elif 'ì¤‘ê¸‰' in value:
        user_data['preferences']['cooking_skill'] = 'ì¤‘ê¸‰'
    elif 'ê³ ê¸‰' in value or 'ìƒê¸‰' in value:  # ğŸ”¥ 'ìƒê¸‰' ì¶”ê°€!
        user_data['preferences']['cooking_skill'] = 'ìƒê¸‰'
    user_data['preferences']['cooking_notes'] = value
```

---

### ìˆ˜ì • 2: ê°€ìš© ì‹œê°„ íŒŒì‹± ê°œì„ 

**íŒŒì¼**: `mcp_servers/notion_server_real.py`
**ìœ„ì¹˜**: 253-293ì¤„

**ì¶”ê°€ëœ ë¡œì§**:
1. ìš°ì„ ìˆœìœ„ 1: ë©”ëª¨ í•„ë“œ(row[2])ì—ì„œ "Xë¶„" íŒ¨í„´ ì¶”ì¶œ (ê¸°ì¡´ ë¡œì§)
2. ìš°ì„ ìˆœìœ„ 2: ì‹œê°„ ë²”ìœ„(row[1])ì—ì„œ "HH:MMâ€“HH:MM" íŒ¨í„´ íŒŒì‹±í•˜ì—¬ ì‹œê°„ ì°¨ì´ ê³„ì‚° (ì‹ ê·œ ì¶”ê°€)

```python
# ğŸ”¥ ë©”ëª¨ê°€ ì—†ìœ¼ë©´ ì‹œê°„ ë²”ìœ„ì—ì„œ ê³„ì‚° (ìš°ì„ ìˆœìœ„ 2)
# "23:00â€“23:15" â†’ 15ë¶„
if user_data['schedule']['available_time'] == 30:  # ì•„ì§ ê¸°ë³¸ê°’ì´ë©´
    time_range_match = re.search(r'(\d{2}):(\d{2})[â€“-](\d{2}):(\d{2})', value)
    if time_range_match:
        start_h, start_m, end_h, end_m = map(int, time_range_match.groups())
        start_minutes = start_h * 60 + start_m
        end_minutes = end_h * 60 + end_m
        
        # ìì • ë„˜ì–´ê°€ëŠ” ê²½ìš° ì²˜ë¦¬ (ì˜ˆ: 23:00â€“01:00)
        if end_minutes < start_minutes:
            end_minutes += 24 * 60
        
        duration = end_minutes - start_minutes
        if 0 < duration <= 120:  # 2ì‹œê°„ ì´ë‚´ë§Œ ìœ íš¨
            user_data['schedule']['available_time'] = duration
```

**íŠ¹ì§•**:
- ìì • ë„˜ì–´ê°€ëŠ” ì‹œê°„ ë²”ìœ„ë„ ì •í™•íˆ ê³„ì‚° (ì˜ˆ: 23:00â€“01:00 = 120ë¶„)
- ë¹„ì •ìƒì ì¸ ë²”ìœ„ í•„í„°ë§ (2ì‹œê°„ ì´ˆê³¼ ì‹œ ë¬´ì‹œ)

---

## âœ… ê²€ì¦ ê²°ê³¼

### ì „ì²´ í˜ë¥´ì†Œë‚˜ íŒŒì‹± í…ŒìŠ¤íŠ¸

| í˜ë¥´ì†Œë‚˜ | ìš”ë¦¬ ì‹¤ë ¥ | ê°€ìš© ì‹œê°„ | ì•Œë ˆë¥´ê¸° | ì˜ì–‘ ëª©í‘œ | ì‹ë‹¨ ê¸°ë¡ | ìƒíƒœ |
|---------|----------|----------|----------|----------|----------|------|
| **ì†Œìœ¤** | **ì´ˆê¸‰** | **15ë¶„** âœ… | ê°‘ê°ë¥˜ | âš ï¸ | 20ê°œ | âœ… |
| **íƒœì‹** | **ì´ˆê¸‰** | 30ë¶„ | ì—†ìŒ | 1700kcal | 15ê°œ | âœ… |
| **ì§€ë¯¼** | **ì¤‘ê¸‰** | 30ë¶„ | ì—†ìŒ | 1900kcal | 21ê°œ | âœ… |
| **í˜„ìš°** | **ì¤‘ê¸‰** | 30ë¶„ | ìœ ë‹¹ë¶ˆë‚´ì¦ | 1800kcal | 21ê°œ | âœ… |
| **ë¼ë¯¸** | **ìƒê¸‰** âœ… | 30ë¶„ | ì—†ìŒ | 2800kcal | 31ê°œ | âœ… |

**ğŸ¯ 5/5 í˜ë¥´ì†Œë‚˜ íŒŒì‹± ì„±ê³µ!**

---

## ğŸ“Š ìƒì„¸ ê²€ì¦ ê²°ê³¼

### ì†Œìœ¤ (ì•¼ê°„ê·¼ë¬´, 15ë¶„ ì‹ì‚¬, ê°‘ê°ë¥˜ ì•Œë ˆë¥´ê¸°)

```
âœ… íŒŒì‹± ì™„ë£Œ ìš”ì•½:
   â€¢ ê±´ê°• ì •ë³´: âš ï¸ (ê±´ê°• ìƒíƒœ ì—†ìŒ)
   â€¢ ì‹ë‹¨ ê¸°ë¡: âœ… (20ê°œ)
   â€¢ ì•Œë ˆë¥´ê¸°: âœ… â†’ ê°‘ê°ë¥˜ ì•Œë ˆë¥´ê¸°(ìƒˆìš°Â·ê²Œ ë“±)
   â€¢ ìš”ë¦¬ ì‹¤ë ¥: âœ… â†’ ì´ˆê¸‰
   â€¢ ì˜ì–‘ ëª©í‘œ: âš ï¸ (Notionì— í…Œì´ë¸” ì—†ìŒ)
   â€¢ ì˜ˆì‚°: âœ… â†’ 26,000ì›/ì¼
   â€¢ ê°€ìš© ì‹œê°„: âœ… â†’ 15ë¶„ â¬… ìˆ˜ì • ì™„ë£Œ!
```

### ë¼ë¯¸ (ë²Œí¬ì—…, ê³ ë‹¨ë°±, ë°€í”„ë ™)

```
âœ… íŒŒì‹± ì™„ë£Œ ìš”ì•½:
   â€¢ ê±´ê°• ì •ë³´: âš ï¸ (ê±´ê°• ìƒíƒœ ì—†ìŒ)
   â€¢ ì‹ë‹¨ ê¸°ë¡: âœ… (31ê°œ)
   â€¢ ì•Œë ˆë¥´ê¸°: ì—†ìŒ
   â€¢ ìš”ë¦¬ ì‹¤ë ¥: âœ… â†’ ìƒê¸‰ â¬… ìˆ˜ì • ì™„ë£Œ!
   â€¢ ì˜ì–‘ ëª©í‘œ: âœ… â†’ 2800kcal, ë‹¨ë°±ì§ˆ 140g
   â€¢ ì˜ˆì‚°: âœ… â†’ 40,000ì›/ì¼
   â€¢ ê°€ìš© ì‹œê°„: âœ… â†’ 30ë¶„
```

---

## ğŸ“ ì†Œìœ¤ì˜ ì˜ì–‘ ëª©í‘œì— ëŒ€í•˜ì—¬

### í˜„í™©
ì‹¤ì œ Notion í˜ì´ì§€ë¥¼ ìƒì„¸íˆ í™•ì¸í•œ ê²°ê³¼:
- âœ… íƒœì‹: ì˜ì–‘ ëª©í‘œ í…Œì´ë¸” ì¡´ì¬ (1700kcal, ë‹¨ë°±ì§ˆ 90g, íƒ„ìˆ˜ 150g, ë‚˜íŠ¸ë¥¨ 2000mg)
- âœ… ì§€ë¯¼: ì˜ì–‘ ëª©í‘œ í…Œì´ë¸” ì¡´ì¬ (1900kcal, ë‹¨ë°±ì§ˆ 80g, ì‹ì´ì„¬ìœ  30g)
- âœ… í˜„ìš°: ì˜ì–‘ ëª©í‘œ í…Œì´ë¸” ì¡´ì¬ (1800kcal, ë‹¨ë°±ì§ˆ 120g, íƒ„ìˆ˜ 180g, ì§€ë°© 50g, ì‹ì´ì„¬ìœ  25g)
- âœ… ë¼ë¯¸: ì˜ì–‘ ëª©í‘œ í…Œì´ë¸” ì¡´ì¬ (2800kcal, ë‹¨ë°±ì§ˆ 140g)
- âš ï¸ **ì†Œìœ¤: ì˜ì–‘ ëª©í‘œ í…Œì´ë¸” ì—†ìŒ**

### ëŒ€ì‘ ë°©ì•ˆ
1. **Notionì— ì¶”ê°€** (ê¶Œì¥): ì†Œìœ¤ì˜ í˜ì´ì§€ì— "ì˜ì–‘ ëª©í‘œ" ì„¹ì…˜ ë° í…Œì´ë¸” ì¶”ê°€ ì‹œ ìë™ íŒŒì‹±
2. **ê¸°ë³¸ê°’ ì„¤ì •**: íŒŒì‹± ë¡œì§ì— ê¸°ë³¸ ì˜ì–‘ ëª©í‘œ ì„¤ì • (í˜„ì¬ëŠ” ë¹ˆ ë”•ì…”ë„ˆë¦¬)

---

## ğŸ‰ ìµœì¢… ê²°ê³¼

### âœ… ëª¨ë“  ë¬¸ì œ í•´ê²° ì™„ë£Œ

1. **ë¼ë¯¸ ìš”ë¦¬ ì‹¤ë ¥**: (ë¹ˆ ë¬¸ìì—´) â†’ **ìƒê¸‰** âœ…
2. **ì†Œìœ¤ ê°€ìš© ì‹œê°„**: 30ë¶„ â†’ **15ë¶„** âœ…
3. **ë¼ë¯¸ ì˜ì–‘ ëª©í‘œ**: 2800kcal, ë‹¨ë°±ì§ˆ 140g âœ… (ì´ë¯¸ ì •ìƒ ì‘ë™)

### ğŸ¯ 5ëª… í˜ë¥´ì†Œë‚˜ ê°œì¸í™” ì •ë³´

| í˜ë¥´ì†Œë‚˜ | í•µì‹¬ íŠ¹ì„± |
|---------|----------|
| **ì†Œìœ¤** | ì•¼ê°„ê·¼ë¬´ Â· **15ë¶„ ì‹ì‚¬** Â· ê°‘ê°ë¥˜ ì•Œë ˆë¥´ê¸° Â· ì´ˆê¸‰ ìš”ë¦¬ |
| **íƒœì‹** | ë‹¹ë‡¨Â·ê³ í˜ˆì•• Â· ì €ì—¼Â·ì €ë‹¹ Â· ì´ˆê¸‰ ìš”ë¦¬(ì „ìë ˆì¸ì§€) Â· 1700kcal |
| **ì§€ë¯¼** | ì±„ì‹ Â· ë²„ì„¯ ê¸°í”¼ Â· ì¤‘ê¸‰ ìš”ë¦¬ Â· 1900kcal Â· ì‹ì´ì„¬ìœ  30g |
| **í˜„ìš°** | ìœ ë‹¹ë¶ˆë‚´ì¦ Â· í—¬ìŠ¤ ë‹¤ì´ì–´í„° Â· ì¤‘ê¸‰ ìš”ë¦¬ Â· 1800kcal Â· ë‹¨ë°±ì§ˆ 120g |
| **ë¼ë¯¸** | ë²Œí¬ì—… Â· **ìƒê¸‰ ìš”ë¦¬**(ì˜¤ë¸Â·ìŠ¬ë¡œìš°ì¿ ì»¤) Â· 2800kcal Â· ë‹¨ë°±ì§ˆ 140g |

**ì§„ì •í•œ ê°œì¸í™” ì‹ì‚¬ ì¶”ì²œ ì™„ì„±!** ğŸ‰

---

## ğŸ§ª ì¬í˜„ ë°©ë²•

### ì „ì²´ í˜ë¥´ì†Œë‚˜ ê²€ì¦
```bash
cd "/Users/namu123/Documents/í…Œí¬ ê´€ë ¨/ê³µí›ˆì˜_AIíŠ¹ê°•/íŒ€í”Œ/crewai-food-app"

# 5ëª… ëª¨ë‘ ê²€ì¦
python -c "
import asyncio
from mcp_servers.notion_server_real import parse_user_page

PERSONAS = {
    'ì†Œìœ¤': '2976b5ca-f706-80a9-88cb-f1f95a3243b3',
    'ë¼ë¯¸': '2976b5ca-f706-809f-bbbe-f3017ea2649a'
}

async def test():
    for name, page_id in PERSONAS.items():
        data = await parse_user_page(page_id)
        print(f'{name}: ìš”ë¦¬ì‹¤ë ¥={data[\"preferences\"][\"cooking_skill\"]}, ê°€ìš©ì‹œê°„={data[\"schedule\"][\"available_time\"]}ë¶„')

asyncio.run(test())
"
```

### Streamlit ì•± í…ŒìŠ¤íŠ¸
```bash
streamlit run app.py
```

1. **ì†Œìœ¤** ì„ íƒ â†’ "ì˜¤ëŠ˜ ì €ë… ì¶”ì²œí•´ì¤˜"
   - ì‘ë‹µì—ì„œ "15ë¶„", "ë¹ ë¥¸ ì‹ì‚¬" ì–¸ê¸‰ í™•ì¸
   - ê°‘ê°ë¥˜ ì œì™¸ ë©”ë‰´ í™•ì¸

2. **ë¼ë¯¸** ì„ íƒ â†’ "ì˜¤ëŠ˜ ì ì‹¬ ì¶”ì²œí•´ì¤˜"
   - ì‘ë‹µì—ì„œ "ìƒê¸‰ ìš”ë¦¬", "ì˜¤ë¸", "ë°€í”„ë ™" ì–¸ê¸‰ í™•ì¸
   - ê³ ë‹¨ë°± ë©”ë‰´ í™•ì¸

---

## ğŸ“š ê´€ë ¨ íŒŒì¼

- `mcp_servers/notion_server_real.py`: íŒŒì‹± ë¡œì§ ìˆ˜ì •
- `ALL_PERSONAS_VALIDATION.md`: ìµœì´ˆ ê²€ì¦ ê²°ê³¼
- `PARSING_FIX_COMPLETE.md`: ë³¸ ë¬¸ì„œ

