# π”§ λ μ‹ν”Ό μΊμ‹ μμ • λ° LLM Judge ν†µν•© μ™„λ£

## π“‹ μ‘μ—… μ™„λ£ μ”μ•½

**μ‚¬μ©μ ν”Όλ“λ°± λ°μ μ™„λ£:**
1. β… **λ μ‹ν”Ό μΊμ‹ μ‹μ¤ν… μ κ±°** β†’ λ¬΄ν• λ£¨ν”„ λ¬Έμ  ν•΄κ²°
2. β… **Chef Agentμ— LLM as Judge μ¶”κ°€** β†’ κ°μΈν™” λ μ‹ν”Ό μƒμ„±

---

## π” λ¬Έμ  1: λ μ‹ν”Ό μΊμ‹ μ‹μ¤ν… - λ¬΄ν• λ£¨ν”„

### λ¬Έμ  ν„μƒ

**ν„°λ―Έλ„ λ΅κ·Έ:**
```
Tool Output: I tried reusing the same input, I must stop using this action input.

Using Tool: AI λ μ‹ν”Ό μƒμ„±
Tool Input: {"dish_name": "λ³¶μλ°¥"}
Tool Output: I tried reusing the same input, I must stop using this action input.

[λ°λ³µ λ¬΄ν• λ£¨ν”„...]
```

### μ›μΈ λ¶„μ„

**μΊμ‹ μ‹μ¤ν…μ λ¬Έμ :**
```python
# κΈ°μ΅΄ μ½”λ“
_recipe_cache = {}

if cache_key in _recipe_cache:
    return f"π³ AI μƒμ„± λ μ‹ν”Ό (μΊμ‹λ¨)\n\n{_recipe_cache[cache_key]}"
```

**λ¬Έμ μ :**
1. β μΊμ‹μ—μ„ λ°ν™λλ” λ©”μ‹μ§€κ°€ ν•­μƒ λ™μΌ
2. β CrewAIκ°€ "κ°™μ€ input μ¬μ‚¬μ©" κ°μ§€
3. β μ—μ΄μ „νΈκ°€ κ°™μ€ λ„κµ¬λ¥Ό κ³„μ† μ¬μ‹λ„
4. β λ¬΄ν• λ£¨ν”„ λ°μƒ

### ν•΄κ²° λ°©λ²•

**μΊμ‹ μ‹μ¤ν… μ™„μ „ μ κ±°:**
```python
# μμ • ν›„ - μΊμ‹ μ κ±°
@tool("AI λ μ‹ν”Ό μƒμ„±")
def generate_recipe_with_ai(
    dish_name: str,
    user_health_info: Optional[str] = ""
) -> str:
    # μΊμ‹ μ—†μ΄ λ§¤λ² μƒλ΅ μƒμ„±
    # κ±΄κ°• μ •λ³΄λ¥Ό λ°μν• κ°μΈν™” λ μ‹ν”Ό
```

**μ¥μ :**
- β… λ¬΄ν• λ£¨ν”„ λ¬Έμ  ν•΄κ²°
- β… λ§¤λ² μƒλ΅μ΄ μ‘λ‹µ μƒμ„±
- β… CrewAIμ μ¤‘λ³µ κ°μ§€ λ©”μ»¤λ‹μ¦κ³Ό μ¶©λ μ—†μ
- β… κ±΄κ°• μ •λ³΄ λ°μμΌλ΅ κ°μΈν™” κ°•ν™”

---

## π¤– λ¬Έμ  2: Chef Agent - κ°μΈν™” λ¶€μ΅±

### λ¬Έμ  ν„μƒ

**λ‹Ήλ‡¨ ν™μ (νƒμ‹)μ—κ² λ¶€μ μ ν• λ μ‹ν”Ό:**
```
μ‚¬μ©μ: "λ³¶μλ°¥ λ§λ“λ” λ²• μ•λ ¤μ¤"
β†’ β μΌλ° λ³¶μλ°¥ λ μ‹ν”Ό (κ³ λ‹ΉΒ·κ³ μ—Ό)
β†’ β λ‹Ήλ‡¨ ν™μμ—κ² μ„ν—ν• λ μ‹ν”Ό
```

### ν•΄κ²° λ°©λ²•

#### 1. λ μ‹ν”Ό μƒμ„± λ„κµ¬ κ°μ„ 

**κ±΄κ°• μ •λ³΄ νλΌλ―Έν„° μ¶”κ°€:**
```python
@tool("AI λ μ‹ν”Ό μƒμ„±")
def generate_recipe_with_ai(
    dish_name: str,
    user_health_info: Optional[str] = ""  # β† μ¶”κ°€
) -> str:
```

**ν”„λ΅¬ν”„νΈμ— κ±΄κ°• κ³ λ ¤μ‚¬ν•­ λ°μ:**
```python
if user_health_info:
    health_consideration = f"""
π¥ **μ¤‘μ”: μ‚¬μ©μ κ±΄κ°• μ •λ³΄ λ°μ**
μ‚¬μ©μ κ±΄κ°• μƒνƒ: {user_health_info}

κ±΄κ°• μƒνƒμ— λ§μ¶° λ μ‹ν”Όλ¥Ό μ΅°μ •ν•΄μ£Όμ„Έμ”:
- λ‹Ήλ‡¨: μ €λ‹Ή, μ €GI μ‹ν’ μ‚¬μ©, μ„¤νƒ• λ€μ‹  μ¤ν…λΉ„μ•„
- κ³ νμ••: μ €μ—Ό, λ‚νΈλ¥¨ μ ν•, κ°„μ¥/μ†κΈ μµμ†ν™”
- λ‹¤μ΄μ–΄νΈ: μ €μΉΌλ΅λ¦¬, κ³ λ‹¨λ°±, μ €μ§€λ°©
- μ±„μ‹: κ³ κΈ° μ μ™Έ, μ‹λ¬Όμ„± μ¬λ£λ§ μ‚¬μ©
"""
```

#### 2. Chef Agent μ—…λ°μ΄νΈ

**LLM as Judge ν†µν•©:**
```python
from tools import (
    generate_recipe_with_ai,
    get_user_preferences,
    get_meal_history,
    judge_menu_personalization  # β† μ¶”κ°€
)
```

**μ‘μ—… ν”„λ΅μ„Έμ¤ κ°•ν™”:**
```
1. μ‚¬μ©μ μ„ νΈλ„ μ΅°ν (κ±΄κ°• μ •λ³΄ ν™•μΈ)
   β†“
2. AI λ μ‹ν”Ό μƒμ„± (κ±΄κ°• μ •λ³΄ λ°μ)
   β†’ dish_name='λ³¶μλ°¥', user_health_info='λ‹Ήλ‡¨Β·κ³ νμ••'
   β†“
3. π¤– LLM as Judge (κ°μΈν™” μ ν•©μ„± νλ‹¨)
   β†’ λ μ‹ν”Όκ°€ λ‹Ήλ‡¨ ν™μμ—κ² μ ν•©ν•μ§€ νλ‹¨
   β†“
4. β λ¶€μ ν•© β†’ λ μ‹ν”Ό μμ • or λ€μ• μ μ‹
   β… μ ν•© β†’ μ‚¬μ©μμ—κ² μ „λ‹¬
```

---

## π“ κ°μ„  μ „ν›„ λΉ„κµ

### κ°μ„  μ „ β

**νƒμ‹ (λ‹Ήλ‡¨Β·κ³ νμ••)μ—κ² "λ³¶μλ°¥ λ§λ“λ” λ²• μ•λ ¤μ¤":**
```
1. μΊμ‹ ν™•μΈ β†’ "λ³¶μλ°¥" μΊμ‹ μμ
2. μΊμ‹μ—μ„ μΌλ° λ μ‹ν”Ό λ°ν™
3. β κ³ λ‹ΉΒ·κ³ μ—Ό λ μ‹ν”Ό (μ„¤νƒ•, κ°„μ¥ λ§μ΄ μ‚¬μ©)
4. β λ‹Ήλ‡¨ ν™μμ—κ² μ„ν—
5. λ¬΄ν• λ£¨ν”„ λ°μƒ (μΊμ‹ μ¬μ‚¬μ© μ—λ¬)
```

---

### κ°μ„  ν›„ β…

**νƒμ‹ (λ‹Ήλ‡¨Β·κ³ νμ••)μ—κ² "λ³¶μλ°¥ λ§λ“λ” λ²• μ•λ ¤μ¤":**
```
1. μ‚¬μ©μ μ„ νΈλ„ μ΅°ν
   β†’ "λ‹Ήλ‡¨Β·κ³ νμ••" ν™•μΈ

2. AI λ μ‹ν”Ό μƒμ„±
   β†’ dish_name='λ³¶μλ°¥'
   β†’ user_health_info='λ‹Ήλ‡¨Β·κ³ νμ••'
   
   κ²°κ³Ό:
   ## λ‹Ήλ‡¨Β·κ³ νμ•• κ³ λ ¤ λ³¶μλ°¥
   - λ°±λ―Έ λ€μ‹  ν„λ―Έ μ‚¬μ©
   - μ„¤νƒ• μ‚¬μ© μ• ν•¨
   - κ°„μ¥ μµμ†ν™” (μ €μ—Ό)
   - μ±„μ† λ§μ΄ μ¶”κ°€
   - μ €GI μ¬λ£ μ‚¬μ©

3. π¤– LLM Judge νλ‹¨:
   "β… μ ν•© - μ €λ‹ΉΒ·μ €μ—Ό λ μ‹ν”Ό, λ‹Ήλ‡¨Β·κ³ νμ•• ν™μμ—κ² μ•μ „"

4. μ‚¬μ©μμ—κ² μ „λ‹¬:
   "λ‹Ήλ‡¨Β·κ³ νμ••μ„ κ³ λ ¤ν• λ³¶μλ°¥ λ μ‹ν”Όμ…λ‹λ‹¤!
   λ°±λ―Έ λ€μ‹  ν„λ―Έλ¥Ό μ‚¬μ©ν•κ³ , μ„¤νƒ•μ€ λ„£μ§€ μ•μ•μµλ‹λ‹¤."
```

---

## π― μ‹λ‚λ¦¬μ¤λ³„ ν…μ¤νΈ

### μ‹λ‚λ¦¬μ¤ 1: λ‹Ήλ‡¨ ν™μ (νƒμ‹) β…

**μ…λ ¥:** "κ°„λ‹¨ν• λ³¶μλ°¥ λ§λ“λ” λ²• μ•λ ¤μ¤"

**μ²λ¦¬ κ³Όμ •:**
1. μ„ νΈλ„ μ΅°ν β†’ λ‹Ήλ‡¨Β·κ³ νμ•• ν™•μΈ
2. λ μ‹ν”Ό μƒμ„± (user_health_info='λ‹Ήλ‡¨Β·κ³ νμ••')
   - λ°±λ―Έ β†’ ν„λ―Έλ΅ λ³€κ²½
   - μ„¤νƒ• μ κ±°
   - κ°„μ¥ μµμ†ν™”
   - μ €GI μ±„μ† μ¶”κ°€
3. LLM Judge β†’ β… μ ν•© νλ‹¨
4. κ°μΈν™” λ μ‹ν”Ό μ κ³µ

**κ²°κ³Ό:** β… λ‹Ήλ‡¨ μ•μ „ λ μ‹ν”Ό!

---

### μ‹λ‚λ¦¬μ¤ 2: μ±„μ‹μ£Όμμ (μ§€λ―Ό) β…

**μ…λ ¥:** "κΉ€μΉλ³¶μλ°¥ λ μ‹ν”Ό μ•λ ¤μ¤"

**μ²λ¦¬ κ³Όμ •:**
1. μ„ νΈλ„ μ΅°ν β†’ λ½ν† μ¤λ³΄ μ±„μ‹ ν™•μΈ
2. λ μ‹ν”Ό μƒμ„± (user_health_info='μ±„μ‹ (λ½ν† μ¤λ³΄)')
   - ν–„/λ² μ΄μ»¨ μ κ±°
   - κ³„λ€μ€ ν¬ν•¨ (λ½ν† μ¤λ³΄ κ°€λ¥)
   - μ±„μ† μ„μ£Ό
3. LLM Judge β†’ β… μ ν•© νλ‹¨
4. μ±„μ‹ λ μ‹ν”Ό μ κ³µ

**κ²°κ³Ό:** β… κ³ κΈ° μ—†λ” λ μ‹ν”Ό!

---

### μ‹λ‚λ¦¬μ¤ 3: λ‹¤μ΄μ–΄ν„° (ν„μ°) β…

**μ…λ ¥:** "μ‚΄ μ• μ°λ” νμ¤νƒ€ λ§λ“λ” λ²•"

**μ²λ¦¬ κ³Όμ •:**
1. μ„ νΈλ„ μ΅°ν β†’ λ‹¤μ΄μ–΄νΈ λ©ν‘ ν™•μΈ
2. λ μ‹ν”Ό μƒμ„± (user_health_info='λ‹¤μ΄μ–΄νΈ')
   - ν¬λ¦Όμ†μ¤ β†’ ν† λ§ν† μ†μ¤
   - νμ¤νƒ€ μ–‘ μ¤„μ„
   - λ‹­κ°€μ΄μ‚΄ μ¶”κ°€ (κ³ λ‹¨λ°±)
   - μ±„μ† λ§μ΄
3. LLM Judge β†’ β… μ ν•© νλ‹¨
4. μ €μΉΌλ΅λ¦¬ λ μ‹ν”Ό μ κ³µ

**κ²°κ³Ό:** β… λ‹¤μ΄μ–΄νΈ λ μ‹ν”Ό!

---

## π“ μμ •λ νμΌ

### μμ •λ νμΌ (2κ°)
1. **`tools/recipe_tools.py`**
   - μΊμ‹ μ‹μ¤ν… μ™„μ „ μ κ±°
   - `user_health_info` νλΌλ―Έν„° μ¶”κ°€
   - κ±΄κ°• κ³ λ ¤μ‚¬ν•­ ν”„λ΅¬ν”„νΈ μ¶”κ°€
   - None μ²΄ν¬ μ¶”κ°€

2. **`agents/chef_agent.py`**
   - `judge_menu_personalization` λ„κµ¬ μ¶”κ°€
   - μ‘μ—… ν”„λ΅μ„Έμ¤μ— κ°μΈν™” λ‹¨κ³„ μ¶”κ°€
   - LLM Judge ν†µν•©

### λ¬Έμ„ (1κ°)
1. **`RECIPE_CACHE_FIX_AND_LLM_JUDGE_COMPLETE.md`** - μ΄ λ³΄κ³ μ„

---

## β… ν•µμ‹¬ κ°μ„ μ‚¬ν•­

### 1. μΊμ‹ μ‹μ¤ν… μ κ±° β…
- **Before**: μΊμ‹ μ¬μ‚¬μ© β†’ λ¬΄ν• λ£¨ν”„
- **After**: λ§¤λ² μƒλ΅ μƒμ„± β†’ μ •μƒ μ‘λ™

### 2. κ±΄κ°• μ •λ³΄ λ°μ β…
- **Before**: μΌλ° λ μ‹ν”Όλ§ μƒμ„±
- **After**: κ±΄κ°• μƒνƒ κ³ λ ¤ν• κ°μΈν™” λ μ‹ν”Ό

### 3. LLM as Judge ν†µν•© β…
- **Before**: λ μ‹ν”Ό μƒμ„± ν›„ κ²€μ¦ μ—†μ
- **After**: LLMμ΄ κ°μΈν™” μ ν•©μ„± νλ‹¨

### 4. μ•μ „μ„± ν™•λ³΄ β…
- λ‹Ήλ‡¨ ν™μμ—κ² κ³ λ‹Ή λ μ‹ν”Ό μ¶”μ² λ°©μ§€
- μ±„μ‹μ£Όμμμ—κ² κ³ κΈ° λ μ‹ν”Ό μ¶”μ² λ°©μ§€
- λ¶€μ ν•© λ μ‹ν”Όλ” λ€μ• μ μ‹

---

## π‰ κ²°λ΅ 

**λ‘ κ°€μ§€ ν•µμ‹¬ λ¬Έμ  ν•΄κ²° μ™„λ£!**

### λ¬Έμ  1: λ μ‹ν”Ό μΊμ‹ λ¬΄ν• λ£¨ν”„ β…
- μΊμ‹ μ‹μ¤ν… μ™„μ „ μ κ±°
- CrewAI μ¤‘λ³µ κ°μ§€μ™€ μ¶©λ ν•΄κ²°
- μ •μƒ μ‘λ™ ν™•μΈ

### λ¬Έμ  2: λ μ‹ν”Ό κ°μΈν™” λ¶€μ΅± β…
- κ±΄κ°• μ •λ³΄ λ°μ λ μ‹ν”Ό μƒμ„±
- LLM as Judgeλ΅ μ ν•©μ„± νλ‹¨
- λ‹Ήλ‡¨, μ±„μ‹, λ‹¤μ΄μ–΄νΈ λ¨λ‘ λ€μ‘

**μ΄μ  Chef Agentλ”:**
1. β… λ¬΄ν• λ£¨ν”„ μ—†μ΄ μ •μƒ μ‘λ™
2. β… κ±΄κ°• μ •λ³΄λ¥Ό λ°μν• κ°μΈν™” λ μ‹ν”Ό μƒμ„±
3. β… LLMμ΄ μ ν•©μ„±μ„ νλ‹¨ν•μ—¬ μ•μ „μ„± ν™•λ³΄
4. β… λ¶€μ ν•© λ μ‹ν”Όλ” λ€μ• μ μ‹

**λ μ‹ν”Ό μ¶”μ²λ„ μ™„λ²½ν•κ² κ°μΈν™”λμ—μµλ‹λ‹¤!** π

---

**μ‘μ—… μ™„λ£ μΌμ‹**: 2025λ…„ 10μ›” 25μΌ

**ν•µμ‹¬ λ³€κ²½μ‚¬ν•­**:
- β… λ μ‹ν”Ό μΊμ‹ μ‹μ¤ν… μ™„μ „ μ κ±° (λ¬΄ν• λ£¨ν”„ ν•΄κ²°)
- β… κ±΄κ°• μ •λ³΄ νλΌλ―Έν„° μ¶”κ°€
- β… Chef Agentμ— LLM as Judge ν†µν•©
- β… κ°μΈν™” λ μ‹ν”Ό μƒμ„± ν”„λ΅μ„Έμ¤ κ°•ν™”

π‰ **λ μ‹ν”Ό μΊμ‹ λ¬Έμ  ν•΄κ²° λ° LLM Judge ν†µν•©μ΄ μ™„λ£λμ—μµλ‹λ‹¤!** π‰

